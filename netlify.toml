# ====== DCORE Blog on Netlify ======

[build]
  # Папка с готовым сайтом
  publish   = "public"
  # Папка с Netlify Functions (если используешь)
  functions = "netlify/functions"
  # Для чистой статики команда сборки не нужна
  command   = ""

[functions]
  node_bundler = "esbuild"

# ----------------- Redirects -----------------

# После отправки формы — на страницу благодарности
[[redirects]]
  from = "/__forms/thanks"
  to   = "/thanks.html"
  status = 302

# Принудительный HTTPS
[[redirects]]
  from = "http://*"
  to   = "https://:splat"
  status = 301
  force  = true

# ----------------- Headers -----------------

# Долгий кэш для статических ассетов
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Не кэшировать HTML (чтобы сразу видеть изменения)
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "no-cache"

# Базовые security-заголовки
[[headers]]
  for = "/*"
  [headers.values]
    X-Content-Type-Options    = "nosniff"
    Referrer-Policy           = "strict-origin-when-cross-origin"
    Permissions-Policy        = "camera=(), geolocation=(), microphone=()"
    Strict-Transport-Security = "max-age=31536000; includeSubDomains; preload"
